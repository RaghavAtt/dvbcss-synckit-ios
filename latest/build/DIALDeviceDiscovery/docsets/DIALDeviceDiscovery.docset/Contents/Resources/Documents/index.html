<!DOCTYPE html>
<html lang="en">
  <head>
    <title>DIALDeviceDiscovery  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    <!-- new top header bar across all sub-frameworks --> <div style="margin:0; width: 100%; padding: 8px 0 8px 8px; background-color: #005" class="header">
    <a href="../../../../../../index.html" style="margin: 0; padding: 0 8px; font-weight: bold; color:white;">
        dvbcss-synckit-ios
    </a>
</div> <!-- shuffle the "view on github" link up to be on the new top header bar --> <style type="text/css">
    header .header-col.header-col--secondary a.header-link {
        position: relative;
        top: -39px;
    }
</style>

  </head>
  <body>


    <a title="DIALDeviceDiscovery  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          DIALDeviceDiscovery Docs
        </a>
        
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/bbc/dvbcss-synckit-ios">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">DIALDeviceDiscovery Reference</a>
      <img class="carat" src="img/carat.png" />
      DIALDeviceDiscovery  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DIALDevice.html">DIALDevice</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DIALDeviceDiscoveryTask.html">DIALDeviceDiscoveryTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DIALServiceDiscovery.html">DIALServiceDiscovery</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DeviceDescription.html">DeviceDescription</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SSDPService.html">SSDPService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SSDPServiceDiscovery.html">SSDPServiceDiscovery</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@DIALDeviceDiscoveryVersionNumber">DIALDeviceDiscoveryVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@DIALDeviceDiscoveryVersionString">DIALDeviceDiscoveryVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_All">SSDPServiceType_All</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_DIAL_MultiScreenOrgService1">SSDPServiceType_DIAL_MultiScreenOrgService1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_Microsoft_MediaReceiverRegistrar1">SSDPServiceType_Microsoft_MediaReceiverRegistrar1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_AVTransport1">SSDPServiceType_UPnP_AVTransport1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_ConnectionManager1">SSDPServiceType_UPnP_ConnectionManager1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_ContentDirectory1">SSDPServiceType_UPnP_ContentDirectory1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_InternetGatewayDevice1">SSDPServiceType_UPnP_InternetGatewayDevice1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_Layer3Forwarding1">SSDPServiceType_UPnP_Layer3Forwarding1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_MediaRenderer1">SSDPServiceType_UPnP_MediaRenderer1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_MediaServer1">SSDPServiceType_UPnP_MediaServer1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_RenderingControl1">SSDPServiceType_UPnP_RenderingControl1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_RootDevice">SSDPServiceType_UPnP_RootDevice</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_SonosZonePlayer1">SSDPServiceType_UPnP_SonosZonePlayer1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_WANCommonInterfaceConfig1">SSDPServiceType_UPnP_WANCommonInterfaceConfig1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_WANConnectionDevice1">SSDPServiceType_UPnP_WANConnectionDevice1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_WANDevice1">SSDPServiceType_UPnP_WANDevice1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@SSDPServiceType_UPnP_WANIPConnection1">SSDPServiceType_UPnP_WANIPConnection1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDeviceExpiryNotification">kDIALDeviceExpiryNotification</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_AllowStopKey">kDIALDevice_AllowStopKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_DIALServerKey">kDIALDevice_DIALServerKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_DIALServiceKey">kDIALDevice_DIALServiceKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_DIALVersionKey">kDIALDevice_DIALVersionKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_DeviceNameKey">kDIALDevice_DeviceNameKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_HbbTVApp2AppURLKey">kDIALDevice_HbbTVApp2AppURLKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_HbbTVInterDevSyncURKey">kDIALDevice_HbbTVInterDevSyncURKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_HbbTV_UserAgentKey">kDIALDevice_HbbTV_UserAgentKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_HostKey">kDIALDevice_HostKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDIALDevice_StateKey">kDIALDevice_StateKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_DeviceType">kDeviceDesc_DeviceType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_FriendlyName">kDeviceDesc_FriendlyName</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_Manufacturer">kDeviceDesc_Manufacturer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_ManufacturerURL">kDeviceDesc_ManufacturerURL</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_ModelDescription">kDeviceDesc_ModelDescription</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_ModelName">kDeviceDesc_ModelName</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_ModelNumber">kDeviceDesc_ModelNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_ModelURL">kDeviceDesc_ModelURL</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_PresentationURL">kDeviceDesc_PresentationURL</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_SerialNumber">kDeviceDesc_SerialNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kDeviceDesc_UDN">kDeviceDesc_UDN</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kHbbTVApp">kHbbTVApp</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kNewDIALDeviceDiscoveryNotification">kNewDIALDeviceDiscoveryNotification</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@kRefreshDiscoveredDevicesNotification">kRefreshDiscoveredDevicesNotification</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DIALDeviceDiscoveryTaskStatus.html">DIALDeviceDiscoveryTaskStatus</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DIALDeviceDiscoveryTaskDelegate.html">DIALDeviceDiscoveryTaskDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SSDPServiceDiscoveryDelegate.html">SSDPServiceDiscoveryDelegate</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <a href='#small-dvbcss-synckit-ios-small-br-dialdevicediscovery-framework' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='small-dvbcss-synckit-ios-small-br-dialdevicediscovery-framework'><small>dvbcss-synckit-ios</small><br/>DIALDeviceDiscovery Framework</h1>

<ul>
<li><strong><a href="#overview">Overview</a></strong></li>
<li><strong><a href="#how-to-use">How to use</a></strong></li>
<li><strong><a href="#run-the-example-app">Run the example app</a></strong></li>
</ul>

<p>This framework provides APIs for the discovery of services via SSDP and the discovery of devices via DIAL, as used in <a href="http://hbbtv.org/resource-library/#specifications">HbbTV 2</a> compliant TVs It allows HbbTV terminals existing on the same network to be discovered by the Companion Screen Application.
Using the DIAL protocol, the Companion Screen Application can launch an HbbTV application on the television.</p>
<a href='#dependencies' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='dependencies'>Dependencies</h4>

<p>The DIALDeviceDiscovery library requires the following dynamic libraries (iOS frameworks) (found in SyncKit):</p>

<ul>
<li>SyncKitConfiguration</li>
<li>SyncKitCollections</li>
<li>SimpleLogger</li>
<li>AsyncSocket</li>
</ul>
<a href='#overview' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='overview'>Overview</h2>
<a href='#service-discovery-via-ssdp' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='service-discovery-via-ssdp'>Service Discovery via SSDP</h4>

<p>The <a href="../../../../../../DIALDeviceDiscovery/Classes/SSDPServiceDiscovery.html">SSDPServiceDiscovery</a> class implements the service discovery API of the library. The API aims at discovering UPnP devices supporting a particular service type in the local network. This class listens for service advertisements on the UPnP multicast address/port and, maintains soft-state. Changes in services table membership are notified to a delegate via the SSDPServiceDiscoveryDelegate protocol.</p>
<a href='#device-discovery-via-dial' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='device-discovery-via-dial'>Device Discovery via DIAL</h4>

<p>The <a href="../../../../../../DIALDeviceDiscovery/Classes/DIALServiceDiscovery.html">DIALServiceDiscovery</a> class implements the API to discover and manage devices on the network running a DIAL server and applications e.g. an HbbTV application.
In the first step of the discovery process, it uses the SSDPServiceDiscovery module to discover services of type <em>DIAL_MultiScreenOrgService1</em>. Subsequently, <a href="../../../../../../DIALDeviceDiscovery/Classes/DIALDeviceDiscoveryTask.html">DIALAppDiscoveryTasks</a> are created and launched to take over the remainder of the device discovery: 1) the Device Description request and 2) the Application Information request.</p>

<p>The discovery of new devices on the network or expiry of currently-known devices by the library is notified to observers via the DIALDeviceDiscoveryDelegate protocol and via event notifications.</p>
<a href='#how-to-use' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='how-to-use'>How to use</h2>
<a href='#1-add-the-framework-and-its-dependencies-to-your-project' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='1-add-the-framework-and-its-dependencies-to-your-project'>1. Add the framework and its dependencies to your project</h4>

<p>A Cocoa Pod version of this library is not currently available. To use this library, you must add it and its dependencies to your project.</p>

<p>You will need the following projects from this repository:</p>

<ul>
<li><a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/.">DIALDeviceDiscovery</a></li>
<li><a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/../SyncKitConfiguration">SyncKitConfiguration</a></li>
<li><a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/../SyncKitCollections">SyncKitCollections</a></li>
<li><a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/../SimpleLogger">SimpleLogger</a></li>
<li><a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/../AsyncSocket">AsyncSocket</a></li>
</ul>

<p>Either include them in your workspace and build them; or build them in this repository&rsquo;s <a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/../synckit.xcworkspace">synckit.xcworkspace</a></p>

<p>Then add them under <em>Linked Frameworks and libraries</em> in your project&rsquo;s target configuration:</p>

<ul>
<li>DIALDeviceDiscovery.framework</li>
<li>SyncKitConfiguration.framework</li>
<li>SyncKitCollections.framework</li>
<li>SimpleLogger.framework</li>
<li>AsyncSocket.framework</li>
</ul>

<p>If you have two XCode instances running you can drag and drop the framework files from their respective project in SyncKit to your own project.</p>
<a href='#2-import-the-header-files' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='2-import-the-header-files'>2. Import the header files</h4>

<p>Import this header file into your source file:</p>
<pre class="highlight plaintext"><code>#import &lt;DIALDeviceDiscovery/DIALDeviceDiscovery.h&gt;

</code></pre>
<a href='#initialise-the-dial-discovery-engine-and-register-for-notifications' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='initialise-the-dial-discovery-engine-and-register-for-notifications'>Initialise the DIAL discovery engine and register for notifications</h4>

<p>Create a DIALDeviceDiscovery instance to look for DIAL supporting devices with an <q>HbbTV</q> DIAL application:</p>
<pre class="highlight plaintext"><code>config = [SyncKitGlobals getInstance];
assert(config!=nil);

LogInfo(@"AppDelegate: Loading DIAL device discovery components .... ");

self.tvDiscoveryComponent = [[DIALServiceDiscovery alloc] initWithApplication:@"HbbTV"];
[self.tvDiscoveryComponent start];
</code></pre>

<p>Register for notifications:</p>
<pre class="highlight plaintext"><code>// register for notifications
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(DIALServiceDiscoveryNotificationReceived:) name:nil object:self.tvDiscoveryComponent];

</code></pre>
<a href='#get-all-currently-discovered-devices' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='get-all-currently-discovered-devices'>Get all currently discovered devices</h4>

<p>Call the getDiscoveredDIALDevices() method to get a list of all currently available devices. Each device is represented by a <a href="../../../../../../DIALDeviceDiscovery/Classes/DIALDevice.html">DIALDevice</a> object</p>
<pre class="highlight plaintext"><code>NSArray*  deviceList =  [_tvDiscoveryComponent getDiscoveredDIALDevices];;

</code></pre>
<a href='#wait-for-and-handle-notifications-about-new-devices-discovered-and-other-devices-leaving' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='wait-for-and-handle-notifications-about-new-devices-discovered-and-other-devices-leaving'>Wait for and handle notifications about new devices discovered and other devices leaving</h4>

<p>Handle kNewDIALDeviceDiscoveryNotification  and kDIALDeviceExpiryNotification notifications.
Here&rsquo;s an example of an event handler:</p>
<pre class="highlight plaintext"><code>/** Handler for DIAL service discovery and update notifications */
- (void) DIALServiceDiscoveryNotificationReceived:(NSNotification*) aNotification
{
    DIALDevice *device;

    if ([[aNotification name] caseInsensitiveCompare:kNewDIALDeviceDiscoveryNotification] == 0) {
    id temp = [[aNotification userInfo] objectForKey:kNewDIALDeviceDiscoveryNotification];

    if ([temp isKindOfClass: [DIALDevice class]] )
    {
      device = (DIALDevice*) temp;

      MWLogDebug(@"App Delegate: Master Device %@ found on network.", device.friendlyName);

      // do something ...
    }


    } else if ([[aNotification name] caseInsensitiveCompare:kDIALDeviceExpiryNotification] == 0)
    {
      device = (DIALDevice*) [[aNotification userInfo] objectForKey:kDIALDeviceExpiryNotification];

      LogInfo(@"App Delegate: Master Device %@ no longer available.", device.friendlyName);

      // do something e.g. tell observers to refresh their device list

      [[NSNotificationCenter defaultCenter] postNotificationName:kRefreshDiscoveredDevicesNotification object:nil];

    // ...

    }
}

</code></pre>
<a href='#run-the-example-app' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='run-the-example-app'>Run the example app</h2>

<p>A demo app called <a href="https://github.com/bbc/dvbcss-synckit-ios/tree/master/DIALDeviceDiscovery/DIALDiscoveryDemo/">DIALDiscoveryDemo</a> is included with the  library. To run the demo,open the DIALDiscoveryDemo workspace (DIALDiscoveryDemo.xcworkspace) in XCode and deploy on your iOS device.
Make sure your TV and your iOS device are both on the same network.</p>

<p>If you want to run your own DIAL server. There are other projects that implement this, such as node_hbbtv by Fraunhofer. The latest build 0.0.10 or later is required. Install it on a computer (on the same network) from npm or obtain it directly from github:
<a href="https://github.com/fraunhoferfokus/node-hbbtv/">https://github.com/fraunhoferfokus/node-hbbtv/</a></p>
<a href='#licence' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='licence'>Licence</h2>

<p>The DIALDiscoveryDemo Framework is developed by BBC R&amp;D and distributed under the Apache License, <a href="http://www.apache.org/licenses/LICENSE-2.0">Version 2.0</a>.</p>

<p>© Copyright 2016 BBC R&amp;D. All Rights Reserved</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; British Broadcasting Corporation, under <a class="link" href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="external">Apache 2.0 open source licence</a></p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
